# Permissions required by the Operator Pod

**Permissions for Operator:**

| Resources                             | Verbs                                    | Comments                                                                                                                                        |
| ------------------------------------- | ---------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| events                                | create, get, list                        | Required by operator SDK                                                                                                                        |
| services                              | create, update, delete, get, list, watch | Required for ActiveGate, OTEL Collector Operator TelemetryIngest, Extensions                                                                   |
| serviceentries.networking.istio.io    | get, list, create, update, delete        | Required by Istio Reconciler                                                                                                                    |
| virtualservices.networking.istio.io   | get, list, create, update, delete        | Required by Istio Reconciler                                                                                                                    |
| configmaps                            | get, list, watch, create, update, delete | Required to access trustedCAs, edgeConnect CA certs, ActiveGate/OneAgent Connection Info, Extension Custom Configuration, NodesController cache |
| secrets                               | get, list, watch, create, update, delete | Required for webhook certificates, OneAgent/ActiveGate AuthToken, ProcessModuleConfig; To access ActiveGate TLS, CustomPullSecret;              |
| daemonsets.apps                       | get, list, watch, create, update, delete | Required by KSPM, LogMonitoring, All Monitoring modes that require host agents                                                                  |
| deployments.apps                      | get, list, watch, create, update, delete | Required by our unit & E2E tests                                                                                                                |
| replicasets.apps                      | get, list, watch, create, update, delete | Required by the nodes controller to check the owner                                                                                             |
| statefulsets.apps                     | get, list, watch, create, update, delete | Required by Extensions, OtelCollector, ActiveGate                                                                                               |
| dynakubes.dynatrace.com               | get, list, watch, update                 | Required for reconciliation                                                                                                                     |
| edgeconnects.dynatrace.com            | get, list, watch, update                 | Required for reconciliation                                                                                                                     |
| pods                                  | get, list, watch                         | Required for operator pod to check if deployed via olm                                                                                          |
| leases.coordination.k8s.io            | get, update, create                      | Required by Operator to guarantee, that only one is running at the same time                                                                    |
| deployments.apps/finalizers           | update                                   |                                                                                                                                                 |
| dynakubes.dynatrace.com/finalizers    | update                                   | Required for reconciliation                                                                                                                     |
| dynakubes.dynatrace.com/status        | update                                   | Required for reconciliation                                                                                                                     |
| edgeconnects.dynatrace.com/finalizers | update                                   | Required for reconciliation                                                                                                                     |
| edgeconnects.dynatrace.com/status     | update                                   | Required for reconciliation                                                                                                                     |

**ClusterRole Permissions for Operator:**

| Resources                                                    | Resource Names                         | Verbs                     | Comments                                                                                                                                                                         |
| ------------------------------------------------------------ | -------------------------------------- | ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| secrets                                                      |                                        | create                    | Required to create init secret in every namespace for CNFS and application monitoring / metadata enrichment                                                                      |
| namespaces                                                   |                                        | get, list, watch, update  | Required for setting the injection labels; Required as soon as a DynaKube is reconciled.; Required by EdgeConnect and DynaKube for requesting the kubeSystem UID                 |
| nodes                                                        |                                        | get, list, watch          | Required by nodes controller for node cache and mark for termination handling                                                                                                    |
| secrets                                                      | dynatrace-dynakube-config              | get, update, delete, list | Required to create init secret in every namespace for CNFS and application monitoring / metadata enrichment                                                                      |
| secrets                                                      | dynatrace-metadata-enrichment-endpoint | get, update, delete, list | Required to create init secret in every namespace for CNFS and application monitoring / metadata enrichment                                                                      |
| mutatingwebhookconfigurations.admissionregistration.k8s.io   | dynatrace-webhook                      | get, update               | Required for setting the CABundles aka. public cert created by our webhook cert controller. These certs are used by the API-Server to create a secure connection to the webhook. |
| validatingwebhookconfigurations.admissionregistration.k8s.io | dynatrace-webhook                      | get, update               | Required for setting the CABundles aka. public cert created by our webhook cert controller. These certs are used by the API-Server to create a secure connection to the webhook. |
| customresourcedefinitions.apiextensions.k8s.io               | dynakubes.dynatrace.com                | get, update               | Required for webhook cert controller.                                                                                                                                            |
| customresourcedefinitions.apiextensions.k8s.io               | edgeconnects.dynatrace.com             | get, update               | Required for webhook cert controller.                                                                                                                                            |
