apiVersion: dynatrace.com/v1beta6
kind: DynaKube
metadata:
  annotations:
    conversion.dynatrace.com/auto-update: "false"
    feature.dynatrace.com/activegate-ignore-proxy: "true"
    feature.dynatrace.com/automatic-kubernetes-api-monitoring: "true"
  labels:
    label: label-value
  name: dynakube
  namespace: default
spec:
  activeGate:
    annotations:
      activegate-annotation-key: activegate-annotation-value
    capabilities:
    - dynatrace-api
    - kubernetes-monitoring
    - metrics-ingest
    customProperties:
      value: activegate-custom-property-value
      valueFrom: activegate-custom-property-value-from
    dnsPolicy: ClusterFirstWithHostNet
    env:
    - name: activegate-env-1
      value: activegate-env-value-1
      valueFrom:
        configMapKeyRef:
          key: activegate-env-from-1
          name: activegate-env-configmap
    - name: activegate-env-2
      value: activegate-env-value-2
      valueFrom:
        configMapKeyRef:
          key: activegate-env-from-2
          name: activegate-env-configmap
    group: activegate-group
    image: activegate-image
    labels:
      activegate-label-key: activegate-label-value
    nodeSelector:
      activegate-node-selector-key: activegate-node-selector-value
    priorityClassName: activegate-priority-class-name
    replicas: 2
    resources:
      limits:
        cpu: "3"
      requests:
        cpu: "3"
    tlsSecretName: activegate-tls-secret-name
    tolerations:
    - key: activegate-toleration-key
      operator: In
      value: activegate-toleration-value
    topologySpreadConstraints:
    - maxSkew: 1
      topologyKey: kubernetes.io/hostname
      whenUnsatisfiable: ScheduleAnyway
  apiUrl: https://url/api
  customPullSecret: pull-secret
  dynatraceApiRequestThreshold: 42
  extensions:
    prometheus: {}
  logMonitoring:
    ingestRuleMatchers:
    - attribute: attribute1
      values:
      - matcher1
      - matcher2
      - matcher3
    - attribute: attribute2
      values:
      - matcher1
      - matcher2
      - matcher3
    - attribute: attribute3
      values:
      - matcher1
      - matcher2
      - matcher3
  metadataEnrichment:
    enabled: false
    namespaceSelector: {}
  networkZone: network-zone
  oneAgent:
    hostGroup: hostgroup-value
    hostMonitoring:
      annotations:
        host-inject-annotation-key: host-inject-annotation-value
      args:
      - host-inject-arg-1
      - host-inject-arg-2
      dnsPolicy: ClusterFirstWithHostNet
      env:
      - name: host-inject-env-1
        value: host-inject-env-value-1
        valueFrom:
          configMapKeyRef:
            key: host-inject-env-from-1
            name: host-inject-env-configmap
      - name: host-inject-env-2
        value: host-inject-env-value-2
        valueFrom:
          configMapKeyRef:
            key: host-inject-env-from-2
            name: host-inject-env-configmap
      image: host-inject-image
      labels:
        host-inject-label-key: host-inject-label-value
      nodeSelector:
        host-inject-node-selector-key: host-inject-node-selector-value
      oneAgentResources:
        limits:
          cpu: "1"
      priorityClassName: host-inject-priority-class
      secCompProfile: seccomp
      tolerations:
      - key: host-inject-toleration-key
        operator: In
        value: host-inject-toleration-value
      version: 1.0.0.20240101-000000
  proxy:
    value: proxy-value
    valueFrom: proxy-from
  skipCertCheck: true
  templates:
    databaseExecutor:
      imageRef: {}
    extensionExecutionController:
      annotations:
        eec-annotation-key1: eec-annotation-value1
        eec-annotation-key2: eec-annotation-value2
      customConfig: custom-eec-config
      customExtensionCertificates: custom-eec-certificate
      imageRef:
        repository: image.repo
        tag: 1.2.3
      labels:
        eec-label-key1: eec-label-value1
        eec-label-key2: eec-label-value2
      resources:
        limits:
          cpu: "3"
        requests:
          cpu: "3"
      tlsRefName: tls-ref-name
      tolerations:
      - key: otelc-toleration-key
        operator: In
        value: otelc-toleration-value
      topologySpreadConstraints:
      - maxSkew: 1
        topologyKey: kubernetes.io/hostname
        whenUnsatisfiable: ScheduleAnyway
      useEphemeralVolume: true
    kspmNodeConfigurationCollector:
      annotations:
        ncc-annotation-key1: ncc-annotation-value1
        ncc-annotation-key2: ncc-annotation-value2
      args:
      - --log-level
      - debug
      - --log-format
      - json
      env:
      - name: ENV1
        value: VAL1
      - name: ENV2
        value: VAL2
      - name: ENV3
        value: VAL3
      imageRef:
        repository: image.repo
        tag: 1.2.3
      labels:
        ncc-label-key1: ncc-label-value1
        ncc-label-key2: ncc-label-value2
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-selector-match-key
              operator: In
              values:
              - node-match-value1
              - node-match-value2
            matchFields:
            - key: node-selector-field-key
              operator: In
              values:
              - node-field-value1
              - node-field-value2
      nodeSelector:
        selector1: node1
        selector2: node2
      priorityClassName: priority-class-name
      resources:
        limits:
          cpu: "3"
        requests:
          cpu: "3"
      tolerations:
      - key: otelc-toleration-key
        operator: In
        value: otelc-toleration-value
      updateStrategy:
        rollingUpdate:
          maxSurge: 1
          maxUnavailable: 50%
        type: RollingUpdate
    logMonitoring:
      annotations:
        logagent-annotation-key1: logagent-annotation-value1
        logagent-annotation-key2: logagent-annotation-value2
      args:
      - --log-level
      - debug
      - --log-format
      - json
      dnsPolicy: ClusterFirstWithHostNet
      imageRef:
        repository: image.repo
        tag: 1.2.3
      labels:
        logagent-label-key1: logagent-label-value1
        logagent-label-key2: logagent-label-value2
      nodeSelector:
        selector1: node1
        selector2: node2
      resources:
        limits:
          cpu: "3"
        requests:
          cpu: "3"
      secCompProfile: seccomp
      tolerations:
      - key: otelc-toleration-key
        operator: In
        value: otelc-toleration-value
    otelCollector:
      annotations:
        otelc-annotation-key1: otelc-annotation-value1
        otelc-annotation-key2: otelc-annotation-value2
      imageRef:
        repository: image.repo
        tag: 1.2.3
      labels:
        otelc-label-key1: otelc-label-value1
        otelc-label-key2: otelc-label-value2
      replicas: 2
      resources:
        limits:
          cpu: "3"
        requests:
          cpu: "3"
      tlsRefName: tls-ref-name
      tolerations:
      - key: otelc-toleration-key
        operator: In
        value: otelc-toleration-value
      topologySpreadConstraints:
      - maxSkew: 1
        topologyKey: kubernetes.io/hostname
        whenUnsatisfiable: ScheduleAnyway
  tokens: token
  trustedCAs: trusted-ca
status:
  activeGate:
    connectionInfoStatus: {}
  codeModules: {}
  dynatraceApi: {}
  kspm: {}
  metadataEnrichment: {}
  oneAgent:
    connectionInfoStatus: {}
