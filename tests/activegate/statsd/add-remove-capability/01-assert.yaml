apiVersion: kuttl.dev/v1beta1
kind: TestAssert
timeout: 300
---
apiVersion: dynatrace.com/v1beta1
kind: DynaKube
metadata:
  name: dynakube
  namespace: dynatrace
spec:
  activeGate:
    capabilities:
      - statsd-ingest
  apiUrl: https://xnl32808.dev.dynatracelabs.com/api
  oneAgent:
    applicationMonitoring: {}
---
apiVersion: v1
kind: Service
metadata:
  labels:
    dynatrace.com/component: activegate
    operator.dynatrace.com/feature: activegate
    operator.dynatrace.com/instance: dynakube
  name: dynakube-activegate
  namespace: dynatrace
  ownerReferences:
    - apiVersion: dynatrace.com/v1beta1
      blockOwnerDeletion: true
      controller: true
      kind: DynaKube
      name: dynakube
spec:
  ports:
    - name: statsd
      port: 18125
      protocol: UDP
      targetPort: statsd-port
  selector:
    dynatrace.com/component: activegate
    operator.dynatrace.com/feature: activegate
    operator.dynatrace.com/instance: dynakube
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
