# Copyright 2020 Dynatrace LLC

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at

#     http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

x-google-marketplace:
  schemaVersion: v2
  applicationApiVersion: v1beta1
  publishedVersion: 0.7.2
  publishedVersionMetadata:
    releaseNote: '<!-- Release notes generated using configuration in .github/release.yml
      at v0.7.2 -->


      ## What''s Changed

      ### Bugfixes

      * Add `labelSelector` to webhook''s `topologySpreadConstraints` by @mjgrzybek
      in https://github.com/Dynatrace/dynatrace-operator/pull/938

      * Use latest version endpoint for agent download by @chrismuellner in https://github.com/Dynatrace/dynatrace-operator/pull/937

      * Fixes oneagent privileged flag by @0sewa0 in https://github.com/Dynatrace/dynatrace-operator/pull/953

      * Update SCCs to match Security Context by @0sewa0 in https://github.com/Dynatrace/dynatrace-operator/pull/950

      * Fixes Istio reconciliation depending on a token check that depends on Istio
      reconciliations by @meik99 in https://github.com/Dynatrace/dynatrace-operator/pull/956

      * Sets priority to 1 for the SCCs by @0sewa0 in https://github.com/Dynatrace/dynatrace-operator/pull/959

      ### Helm changes

      * Fixes kubeversion property in Chart.yaml by @meik99 in https://github.com/Dynatrace/dynatrace-operator/pull/962



      **Full Changelog**: https://github.com/Dynatrace/dynatrace-operator/compare/v0.7.1...v0.7.2'
    releaseTypes:
    - Feature
    recommended: true
  managedUpdates:
    kalmSupported: true
  images:
    ? ''
    : properties:
        image:
          type: FULL
  deployerServiceAccount:
    description: Service account used to configure the Dynatrace Operator
    roles:
    - type: ClusterRole
      rulesType: CUSTOM
      rules:
      - apiGroups:
        - admissionregistration.k8s.io
        resources:
        - mutatingwebhookconfigurations
        verbs:
        - get
        - create
        - list
        - patch
      - apiGroups:
        - dynatrace.com
        resources:
        - dynakubes
        verbs:
        - get
        - list
        - create
        - patch
      - apiGroups:
        - apiextensions.k8s.io
        resources:
        - customresourcedefinitions
        verbs:
        - get
        - list
        - create
        - patch
      - apiGroups:
        - dynatrace.com
        resources:
        - dynakubes
        verbs:
        - get
        - list
        - watch
        - update
        - patch
      - apiGroups:
        - app.k8s.io
        resources:
        - applications
        verbs:
        - get
        - list
      - apiGroups:
        - storage.k8s.io
        resources:
        - csidrivers
        verbs:
        - '*'
      - apiGroups:
        - ''
        resources:
        - services
        - serviceaccounts
        verbs:
        - '*'
      - apiGroups:
        - rbac.authorization.k8s.io
        resources:
        - role
        - rolebinding
        - clusterroles
        - clusterrolebindings
        verbs:
        - '*'
      - apiGroups:
        - admissionregistration.k8s.io
        resources:
        - validatingwebhookconfigurations
        verbs:
        - '*'
properties:
  name:
    type: string
    x-google-marketplace:
      type: NAME
  namespace:
    type: string
    x-google-marketplace:
      type: NAMESPACE
    default: dynatrace
  deployerHelm.image:
    type: string
    x-google-marketplace:
      type: DEPLOYER_IMAGE
  customPullSecret:
    type: string
    title: Custom pull secret
    description: If the Operator image is in a private registry, the name of the appropriate
      pull secret can be set here
    default: ''
  operator.apparmor:
    type: boolean
    title: Enables AppArmor for Operator
    description: 'AppArmor is a security system for Linux.

      If a cluster supports AppArmor the Operator uses it if it is enabled here.

      If it is not supported by a cluster it must not be enabled.

      '
    default: false
  operator.requests.cpu:
    type: string
    title: Operator CPU request
    description: The amount of CPU allocation the Operator requests from the cluster.
    default: 50m
  operator.requests.memory:
    type: string
    title: Operator Memory request
    description: The amount of memory allocation the Operator requests from the cluster.
    default: 64Mi
  operator.limits.cpu:
    type: string
    title: Operator  CPU limit
    description: The amount of CPU allocation to which the cluster may limit the Operator.
    default: 100m
  operator.limits.memory:
    type: string
    title: Operator Memory limit
    description: The amount of memory allocation to which the cluster may limit the
      Operator.
    default: 128Mi
  webhook.hostNetwork:
    type: boolean
    title: Webhook uses Host network
    description: 'Allows the webhook to connect with and use the same network as the
      node.

      May alleviate issues with container network interfaces (CNI).

      '
    default: false
  webhook.apparmor:
    type: boolean
    title: Enables AppArmor for Webhook
    description: 'AppArmor is a security system for Linux.

      If a cluster supports AppArmor the Webhook uses it if it is enabled here.

      If it is not supported by a cluster it must not be enabled.

      '
    default: false
  webhook.requests.cpu:
    type: string
    title: Webhook CPU request
    description: 'The amount of CPU allocation the Webhook requests from the cluster.

      It is recommended for the CPU requests to be the same as the CPU limits.

      '
    default: 300m
  webhook.requests.memory:
    type: string
    title: Webhook Memory request
    description: 'The amount of memory allocation the Webhook requests from the cluster.

      It is recommended for the memory requests to be the same as the memory limits.

      '
    default: 128Mi
  webhook.limits.cpu:
    type: string
    title: Webhook CPU limit
    description: 'The amount of CPU allocation to which the cluster may limit the
      Webhook.

      It is recommended for the CPU limits to be the same as the CPU requests.

      '
    default: 300m
  webhook.limits.memory:
    type: string
    title: Webhook Memory limit
    description: 'The amount of memory allocation to which the cluster may limit the
      Webhook.

      It is recommended for the memory limits to be the same as the memory requests.

      '
    default: 128Mi
  webhook.highAvailability:
    type: boolean
    title: Enables Webhook's high availability mode
    description: Increases replicas and adds topology constraints for the Webhook.
    default: false
  csidriver.enabled:
    type: boolean
    title: Enables CSI driver
    description: The CloudNativeFullStack as well as AppOnly mode need the CSI driver
      to function properly.
    default: false
  csidriver.requests.cpu:
    type: string
    title: CSI driver CPU request
    description: 'The amount of CPU allocation the CSI driver requests from the cluster.

      It is recommended for the CPU requests to be the same as the CPU limits.

      '
    default: 300m
  csidriver.requests.memory:
    type: string
    title: CSI driver Memory request
    description: 'The amount of memory allocation the CSI driver requests from the
      cluster.

      It is recommended for the memory requests to be the same as the memory limits.

      '
    default: 100Mi
  csidriver.limits.cpu:
    type: string
    title: CSI driver CPU limit
    description: 'The amount of CPU allocation to which the cluster may limit the
      CSI driver.

      It is recommended for the CPU limits to be the same as the CPU requests.

      '
    default: 300m
  csidriver.limits.memory:
    type: string
    title: CSI driver Memory limit
    description: 'The amount of memory allocation to which the cluster may limit the
      CSI driver.

      It is recommended for the memory limits to be the same as the memory requests.

      '
    default: 100Mi
  installCRD:
    type: boolean
    title: Install DynaKube CRD
    description: 'Tells the Helm chart of the deployer to install the custom resource
      definition (CRD) of the DynaKube API.

      '
    default: true
    enum:
    - true
  platform:
    type: string
    title: Platform
    description: Platform to deploy on. This should always be set to "google" for
      GKE clusters
    default: google
    enum:
    - google
required:
- name
- namespace
